I"ô<h1 id="smoke-and-cigar-strings">Smoke and CIGAR (strings)</h1>

<p>The â€˜CIGARâ€™ (Compact Idiosyncratic Gapped Alignment Report) string is how the SAM/BAM format represents spliced alignments. Understanding the CIGAR string will help you understand how your query sequence aligns to the reference genome. For example, the position stored is the left most coordinate of the alignment. To get to the right coordinate, you have to parse the CIGAR string.</p>

<p>Letâ€™s consider a few concrete examples. First example: The shown alignment will give position = 2 (0-based!) and CIGAR = 6M:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>AAGTCTAGAA (ref) 
  GTCTAG (query)
</code></pre></div></div>

<p>CIGAR strings have a number of operators:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>M	Match 		Exact match of x positions
N	Alignment gap 	Next x positions on ref donâ€™t match
D	Deletion 	Next x positions on ref donâ€™t match
I	Insertion 	Next x positions on query donâ€™t match
</code></pre></div></div>

<p>For CIGAR =â€™6Mâ€™, this means there are 6 exact matches to the reference. So if we are starting at position=2, with 6 exact matches, we would end at position 7 (again 0-based):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0123456789
AAGTCTAGAA (ref) 
  GTCTAG (query)
</code></pre></div></div>

<p>Second example: The shown alignment will give position=2 (0-based) and CIGAR=3M2I3M:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0123456789
AAGTC  TAGAA (ref) 
  GTCGATAG (query)
</code></pre></div></div>

<p>Here, two nucleotides (â€˜GAâ€™) are inserted into the query. So if we are starting at position=2, based on the CIGAR string, we have 3 exact matches, 2 insertions, then 3 more exact matches, resulting in an end position of 9.</p>

<p>Third example: The shown alignment will give position=2 and CIGAR=2M1D3M:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>0123456789
AAGTCTAGAA (ref) 
  GT TAG (query)
</code></pre></div></div>

<p>Note there is a deletion on the query. The â€˜Câ€™ in the reference sequence has no match. So if we are starting at position=2, based on the CIGAR string, we have 2 exact matches, 1 deletion, then 3 more exact matches, resulting in an end position of 7 relative to the reference.</p>

<p>Fourth example: The shown alignment will give position=3 and CIGAR=3M7N4M:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>01234567890123456
CCCTACGTCCCAGTCAC (ref) 
   TAC       TCAC (query)
</code></pre></div></div>

<p>This is a gapped alignment (due to a splicing event in RNAseq). So if we are starting at position=3, based on the CIGAR string, we have 3 exact matches, 7 gaps, then 4 more exact matches, resulting in an end position of 16.</p>

<h2 id="additional-resources">Additional resources</h2>
<ul>
  <li><a href="https://samtools.github.io/hts-specs/SAMv1.pdf">SAM documentation</a></li>
  <li><a href="https://genome.sph.umich.edu/wiki/SAM">UMICH Center for Statistical Genetics</a></li>
  <li><a href="http://zenfractal.com/2013/06/19/playing-with-matches/">Playing With Matches and CIGARs</a></li>
</ul>

:ET