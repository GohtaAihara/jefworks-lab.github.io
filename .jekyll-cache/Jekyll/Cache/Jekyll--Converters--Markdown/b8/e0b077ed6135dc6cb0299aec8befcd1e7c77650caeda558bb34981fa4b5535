I"lA<h1 id="fun-with-word2vec-exploring-the-application-of-deep-learning-on-biomedical-literature">Fun with Word2vec: Exploring the application of deep learning on biomedical literature</h1>

<p>I’m currently learning more about immunology so I can apply it to my analyses of the tumor micro-environment. However, there’s quite a lot of background literature to catch up on! I must have spent a whole day just trying to figure out all of these CD markers. What expresses CD31415926 again? Has this cell-type been characterized before? If so, what are some other good gene markers? So much Googling, so little reward.</p>

<p>In this day and age of computer-assisted <em>everything</em>, can I apply some artificial intelligence to help me connect these dots faster?</p>

<h2 id="background">Background</h2>

<h3 id="about-word2vec">About Word2vec</h3>
<p>Word2vec is a machine learning approach developed by researchers at Google that apply neural networks to reconstruct the linguistic contexts of words. On a basic level, you can input a large corpus of text such as a database of research abstracts and Word2vec will convert this text corpus into a set of vectors such that words that share common contexts in the corpus are located in close proximity in vector space.</p>

<p>Just like for single-cell RNA-seq analysis where we can represent a cell as many genes quantified by nUMI, now we use Word2vec to represent research abstracts as a vector of many words quantified by some neural network derived quantifications.</p>

<h3 id="about-pubmed">About PubMed</h3>
<p>PubMed is a database of abstracts for more than 27 million scientific research articles.</p>

<h3 id="word2vec-for-pubmed">Word2vec for PubMed</h3>
<p><a href="http://bio.nlplab.org/">Pyysalo et al.</a> previously created resources from the entire available biomedical scientific literature, a text corpus of over five billion words, using Word2vec.</p>

<h2 id="exploring-word2vec-for-pubmed">Exploring Word2vec for PubMed</h2>

<p>We will use the <code class="highlighter-rouge">PubMed-w2v.bin</code> Word2vec output that Pyysalo et al. have already created: <a href="http://evexdb.org/pmresources/vec-space-models/">http://evexdb.org/pmresources/vec-space-models/</a></p>

<p>Benjamin Schmidt also created a nice R package called <code class="highlighter-rouge">wordVectors</code> for exploring such Word2vec outputs: <a href="https://github.com/bmschmidt/wordVectors">https://github.com/bmschmidt/wordVectors</a></p>

<p>(Warning: The file is quite big and may take awhile to download and load)</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#devtools::install_github("bmschmidt/wordVectors")</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">wordVectors</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">magrittr</span><span class="p">)</span><span class="w">
</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">read.binary.vectors</span><span class="p">(</span><span class="s2">"PubMed-w2v.bin"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Let’s first try to apply Word2vec to characterize the cell-type expressing CD19. We know this to be a B-cell marker, but suppose we didn’t know that. All we see from our single-cell analysis is that there is a cluster of cells being marked by expression of some gene called CD19.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">test</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">closest_to</span><span class="p">(</span><span class="s2">"CD19+"</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">=</span><span class="m">100</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">test</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">      </span><span class="n">word</span><span class="w"> </span><span class="n">similarity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s2">"CD19+"</span><span class="w">
 </span><span class="m">1</span><span class="w">   </span><span class="n">CD19</span><span class="o">+</span><span class="w">             </span><span class="m">1.0000000</span><span class="w">
 </span><span class="m">2</span><span class="w">   </span><span class="n">CD20</span><span class="o">+</span><span class="w">             </span><span class="m">0.9026835</span><span class="w">
 </span><span class="m">3</span><span class="w">   </span><span class="n">CD38</span><span class="o">+</span><span class="w">             </span><span class="m">0.8998805</span><span class="w">
 </span><span class="m">4</span><span class="w">    </span><span class="n">CD5</span><span class="o">+</span><span class="w">             </span><span class="m">0.8862646</span><span class="w">
 </span><span class="m">5</span><span class="w"> </span><span class="n">HLA</span><span class="o">-</span><span class="n">DR</span><span class="o">+</span><span class="w">             </span><span class="m">0.8825798</span><span class="w">
 </span><span class="m">6</span><span class="w">    </span><span class="n">CD2</span><span class="o">+</span><span class="w">             </span><span class="m">0.8808907</span><span class="w">
</span></code></pre></div></div>

<p>From Word2vec, we get a list of words similar to CD19. Indeed, a lot of them look like marker genes. But this is honestly still hard for me to interpret. At least now I’ve expanded my list of markers to other genes potentially related to my cell-type of interest. Since most of these words look like gene names, let’s run a gene set enrichment to see if these genes are enriched in any previously annotated gene sets.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">val</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">test</span><span class="p">[,</span><span class="m">2</span><span class="p">]</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">test</span><span class="p">[,</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s1">'[+]'</span><span class="p">,</span><span class="w"> </span><span class="s1">''</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="w">
</span><span class="n">val</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sort</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">decreasing</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">barplot</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="w">

</span><span class="n">library</span><span class="p">(</span><span class="n">liger</span><span class="p">)</span><span class="w">
</span><span class="n">load</span><span class="p">(</span><span class="s1">'~/Resources/genesets/org.Hs.MSigDB2Symbol.RData'</span><span class="p">)</span><span class="w">
</span><span class="n">go.env</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.list</span><span class="p">(</span><span class="n">go.env</span><span class="p">)</span><span class="w">
</span><span class="n">vi</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grepl</span><span class="p">(</span><span class="s1">'GSE'</span><span class="p">,</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">go.env</span><span class="p">))</span><span class="w"> </span><span class="c1">## limit to smaller set of gene sets</span><span class="w">
</span><span class="n">go.sub</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">go.env</span><span class="p">[</span><span class="n">vi</span><span class="p">]</span><span class="w">
</span><span class="n">gsea.results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">iterative.bulk.gsea</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">set.list</span><span class="o">=</span><span class="n">go.sub</span><span class="p">,</span><span class="w"> </span><span class="n">rank</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span><span class="n">gsea.results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gsea.results</span><span class="p">[</span><span class="n">order</span><span class="p">(</span><span class="n">gsea.results</span><span class="o">$</span><span class="n">q.val</span><span class="p">,</span><span class="w"> </span><span class="n">decreasing</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">),]</span><span class="w"> </span><span class="c1">## order by significance</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">gsea.results</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">                                                </span><span class="n">p.val</span><span class="w">      </span><span class="n">q.val</span><span class="w">   </span><span class="n">sscore</span><span class="w">      </span><span class="n">edge</span><span class="w">
 </span><span class="n">GSE22886_NAIVE_BCELL_VS_NEUTROPHIL_UP</span><span class="w">     </span><span class="m">0.00969903</span><span class="w"> </span><span class="m">0.04005155</span><span class="w"> </span><span class="m">1.000000</span><span class="w"> </span><span class="m">0.8151171</span><span class="w">
 </span><span class="n">GSE12845_IGD_POS_VS_NEG_BLOOD_BCELL_UP</span><span class="w">    </span><span class="m">0.00849915</span><span class="w"> </span><span class="m">0.04005155</span><span class="w"> </span><span class="m">1.029851</span><span class="w"> </span><span class="m">0.8006964</span><span class="w">
 </span><span class="n">GSE22886_NAIVE_BCELL_VS_MONOCYTE_UP</span><span class="w">       </span><span class="m">0.00969903</span><span class="w"> </span><span class="m">0.04005155</span><span class="w"> </span><span class="m">1.000000</span><span class="w"> </span><span class="m">0.8151171</span><span class="w">
 </span><span class="n">GSE29618_BCELL_VS_MDC_DAY7_FLU_VACCINE_UP</span><span class="w"> </span><span class="m">0.00969903</span><span class="w"> </span><span class="m">0.04005155</span><span class="w"> </span><span class="m">1.000000</span><span class="w"> </span><span class="m">0.8151171</span><span class="w">
 </span><span class="n">GSE22886_NAIVE_BCELL_VS_DC_UP</span><span class="w">             </span><span class="m">0.00909909</span><span class="w"> </span><span class="m">0.04005155</span><span class="w"> </span><span class="m">1.014706</span><span class="w"> </span><span class="m">0.8006964</span><span class="w">
 </span><span class="n">GSE11057_CD4_CENT_MEM_VS_PBMC_UP</span><span class="w">          </span><span class="m">0.01029897</span><span class="w"> </span><span class="m">0.04005155</span><span class="w"> </span><span class="m">1.000000</span><span class="w"> </span><span class="m">0.8141597</span><span class="w">
</span></code></pre></div></div>

<p>Indeed, we see a lot of gene sets related to B-cells being enriched. Therefore, we may think that CD19 is a B-cell marker and indeed it is.</p>

<p>Now that we’ve confirmed our suspicions that CD19 is a marker for B-cells, can we use analogies to figure out what would be a good marker for monocytes? SAT question time! B-cell is to CD19+ as monocyte is to…</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">model</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">closest_to</span><span class="p">(</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"CD19+"</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s2">"B-Cell"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"Monocyte"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w">            </span><span class="n">word</span><span class="w"> </span><span class="n">similarity</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="s2">"CD19+"</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s2">"B-Cell"</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">"Monocyte"</span><span class="w">
 </span><span class="m">1</span><span class="w">      </span><span class="n">monocyte</span><span class="w">                                     </span><span class="m">0.7410244</span><span class="w">
 </span><span class="m">2</span><span class="w">      </span><span class="n">Monocyte</span><span class="w">                                     </span><span class="m">0.7229452</span><span class="w">
 </span><span class="m">3</span><span class="w">         </span><span class="n">CD14</span><span class="o">+</span><span class="w">                                     </span><span class="m">0.7103301</span><span class="w">
 </span><span class="m">4</span><span class="w">         </span><span class="n">CD16</span><span class="o">+</span><span class="w">                                     </span><span class="m">0.6764755</span><span class="w">
 </span><span class="m">5</span><span class="w">       </span><span class="n">CD14</span><span class="p">(</span><span class="o">+</span><span class="p">)</span><span class="w">                                     </span><span class="m">0.6722145</span><span class="w">
 </span><span class="m">6</span><span class="w">       </span><span class="n">HLA</span><span class="o">-</span><span class="n">DR</span><span class="o">+</span><span class="w">                                     </span><span class="m">0.6644126</span><span class="w">
 </span><span class="m">7</span><span class="w">  </span><span class="n">CD14</span><span class="p">(</span><span class="n">bright</span><span class="p">)</span><span class="w">                                     </span><span class="m">0.6557364</span><span class="w">
 </span><span class="m">8</span><span class="w">         </span><span class="n">CD19</span><span class="o">+</span><span class="w">                                     </span><span class="m">0.6550736</span><span class="w">
 </span><span class="m">9</span><span class="w">     </span><span class="n">monocytes</span><span class="w">                                     </span><span class="m">0.6453974</span><span class="w">
 </span><span class="m">10</span><span class="w">    </span><span class="n">CD4</span><span class="o">+</span><span class="n">CD29</span><span class="o">+</span><span class="w">                                     </span><span class="m">0.6446330</span><span class="w">
</span></code></pre></div></div>

<p>…(ignoring the repeats of our query terms)…CD14+ and CD16+ !!! Hurray!!!</p>

<p>What other interesting things can we do with Word2vec? Stay tuned ;)</p>

:ET